# 05. 안정 해시 설계
 * 수평적 규모 확장성을 달성하기 위해서는 요청 또는 데이터를 서버에 균등하게 나누는 것이 중요하다.
 * 안정 해시는 이 목표를 달성하기 위해 보편적으로 사용하는 기술이다.

## 해시 키 재배치 문제
 * N개의 캐시 서버가 있고, 이 서버들에 부하를 균등하게 나누는 보편적 방법은 아래의 해시 함수를 사용하는 것이다.
> server index = hash(key) % N (N은 서버의 개수)

 * 이 방법은 서버 풀의 크기가 고정되어 있을때 그리고 데이터 분포가 균등할 때 잘 동작한다.
 * 하지만 서버가 추가되거나 삭제되면 문제가 생긴다.
 * 하나의 서버가 추가/삭제되면 위 해서 연산으로 인한 결과 서버 인덱스가 달라지기 때문이다.

## 안정 해시 (consistent hash)
 * 위키피디아에 따르면, 안정 해시는 해시 테이블 크기가 조정될 때 평균적으로 k/n개의 키만 재배치하는 해시 기술이다.
 * k: 키 개수, n: 슬롯 개수
 * 전통적 해시 테이블은 슬롯 수가 바뀌면 거의 대부분 키를 재배치한다.

### 해시 공간과 해시 링
 * 해시 함수 출력 값 범위를 x0, x1, x2 ... xn 이라고 하자
 * 이중 첫 값과 끝 값을 연결하면 링을 만들 수 있다.
 * 이 링 어딘가에 해시 키를 적절히 배치하고, 서버 또한 해시 함수를 사용하여 링 위에 어떤 위치에 배치시킬 수 있다.
 * 여기에 해시 서버와

![Uploading image.png…]()
