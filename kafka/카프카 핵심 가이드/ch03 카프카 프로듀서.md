# 3장 카프카 프로듀서

## 3.1 프로듀서 개요
 * 카프카에 메시지를 쓰는 작업은 ProducerRecord 객체를 생성함으로써 시작된다.
 * 여기서 토픽과 밸류 지정은 필수사항이지만, 키와 파티션 지정은 선택사항이다.
 * ProducerRecord 를 전송하는 API를 호출했을 때 프로듀서가 가장 먼저 하는 일은 키와 값 객체가 네트워크 상에서 전송될 수 있도록 직렬화해서 바이트 배열로 변환하는 과정이다.
 * 그다음은 파티션 지정을 위해 파티셔너에게 보낸다. 파티셔너 결정은 ProducerRecord 객체의 키 값.
 * 파티션이 결정되면, 이 레코드를 같은 토픽 파티션으로 전송될 레코드들을 모은 레코드 배치 (reocrd batch)에 추가한다.
 * 그러면 별도의 스레드가 이 레코드 배치를 적절한 카프카 브로커에게 전송한다.
 * 브로커가 메시지를 받으면 응답을 주는데, 레코드 오프셋을 담은 RecordMetadata 객체를 리턴한다.


#### 카프카 프로듀서 요소 개괄
![image](https://github.com/user-attachments/assets/fa4da5b3-e31a-47e4-807e-3a289cdcd7be)


## 3.2 카프카 프로듀서 생성하기 - 필수 속성값 3가지
### bootstrap.servers
 * 프로듀서가 사용할 브로커의 hostLport 목록
 * 모든 브로커를 포함할 필요는 없다. - 첫 연결을 생성한 뒤 추가정보를 받아오기 떄문.
 * 그러나 혹시 브로커 하나가 작동을 정지하는 경우도 있으니, 최소 2개 이상 지정할 것을 권장.

### key.serializer
 * 카프카에 쓸 레코드의 키 값을 직렬화하기 위한 시리얼라이저 클레스 이름.
 * 카프카 브로커는 메시지의 키값, 밸류값으로 바이트 배열을 받는다.
 * 자주 사용되는 타입은 카프카의 client 패키지에 미리 구현되어 있으니, 쓰면 된다.
 * 키 없이 밸류만 보낼때도 설정해줘야 한다. 이땐 VoidSerializer 를 설정할 수 있다.

### value.serializer
 * 키 시리얼라이저와 동일.

### 프로듀서 전송 방법 3가지
 1. fire and forget - 전송 후 성공이나 실패 여부 신경쓰지 않음.
 2. Synchronous send - 카프카 프로듀서는 언제나 비동기적으로 동작. send() 메서드 호출 후 Future 객체를 리턴받으면 get 메서드를 통해 작업 완료 확인 후 다음 메시지 전송
 3. asynchronous sned - 콜백 함수와 함께 send() 메서드 호출

## 3.4 프로듀서 설정하기
### client.id
 * 
### acks


### 3.4.3 메시지 전달 시간


#### 카프카 프로듀서 내부 메시지 전달 시간을 작업별로 나눈 개념도
![image](https://github.com/user-attachments/assets/4311d26e-f7dd-4a89-94a4-6efc201e2b50)
